generator client {
  provider = "prisma-client-js"
  previewFeatures = ["prismaSchemaFolder"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  privyId       String    @unique
  walletAddress String?
  email         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  karya         Karya[]
  licenses      License[]

  @@map("users")
}

model Karya {
  id          String    @id
  userId      String
  title       String
  description String
  type        String
  category    String?
  tag         String[]
  fileUrl     String
  fileHash    String
  nftId       String?
  txHash      String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  licenses    License[]

  @@map("karya")
}

model License {
  id          String   @id @default(cuid())
  karyaId     String
  userId      String
  type        String
  price       Float
  duration    Int
  description String
  tnc         String
  txHash      String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  karya       Karya    @relation(fields: [karyaId], references: [id], onDelete: Cascade)
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("licenses")
}
